webpackJsonp([81,27],{356:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(11),s=n(r),o=i(4),a=n(o),u={log:function l(e,t){var i={event:e};s["default"].isUndefined(t)||(i.sample_rate=t);var n=a["default"].create("IncrementEventResource",i);n.callCreate({showError:!1})}};e.exports=u},360:function(e,t,i){e.exports=function(){return new Promise(function(e){!function(t){e(i(112))}(i)})}},633:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(11),s=n(r),o=i(37),a=n(o),u=i(9),l=n(u),d=i(951),c=n(d),p=i(1040),h=n(p),f=i(185),_=n(f),m=i(360),v=n(m),x=i(45),S=n(x),T=i(1373),g=n(T),M=i(123),y=n(M),E=i(1947),P=n(E),I=i(51),w=n(I),A=i(8),b=n(A),O=i(58),N=n(O),R=i(13),U=n(R),C=i(250),L=n(C),D=S["default"].getLogger("ExperienceTutorialManager"),F=function B(){this.TUTORIAL_MAP={},this.TUTORIAL_MAP[0]=h["default"],this.TUTORIAL_MAP[9]=P["default"],this.TUTORIAL_MAP[8]=g["default"],L["default"].setExperienceTutorialManager(this),this.init()};F.prototype={init:function k(){this._isActive=!1,this.experience=null,this.tutorial=null,this.currentStep=0,this.steps=null},startTutorial:function Y(e){var t=this;if(L["default"].isTutorialActive())return Promise.reject(new Error("another tutorial is already active"));var i=this._getStoredData();return!i||e&&i.experience.id!==e.id||(e=i.experience,this.currentStep=i.step),e&&void 0!==e.type&&s["default"].has(this.TUTORIAL_MAP,e.type)?(this._isActive=!0,this.experience=e,this.tutorial=new this.TUTORIAL_MAP[this.experience.type](this.experience,this),b["default"].instance.subscribe("tutorial","tutorialGoToStep",function(e,i,n){t._setStep(n)}),this.tutorial.onStart().then(function(){return t.steps=t.experience.display_data.steps,t._funnelPrefix="tutorial_"+t.experience.id,t._setStep(t.currentStep)},function(){t._isActive=!1})):Promise.reject(new Error("invalid placedExperience or no placedExperience to be resumed"))},_next:function G(){return!this.steps||this.currentStep>=this.steps.length-1?this._endTutorial(!0,!0):this._setStep(this.currentStep+1)},_previous:function K(){return this.currentStep<=0?this._endTutorial(!1):this._setStep(this.currentStep-1)},_dismiss:function V(){this._endTutorial(!1)},_endTutorial:function H(e,t){var i=function(){var i=this.experience.experience_id,n=this.experience.display_data,r=n.nextUrlInfo,s=r?r.url:null,o=r?r.forceRefresh:!1,u=r?r.forceFullPageRefresh:!1,l=!!n.relaunchPlacement,d=l?this.experience.placement_id:null;this.clearStoredData(),this.init();var p=Promise.resolve();return e&&s?!function(){var e=new y["default"];u?(0,a["default"])(s):o&&(e.evt=new c["default"]("",null,{forceRefresh:1})),(0,v["default"])().then(function(t){t.navigate(s,e)})}():l&&d&&(p=(0,_["default"])().then(function(e){return e.launchPlacedExperience(d)})),p.then(function(){t&&b["default"].instance.publish(i,"pulserClicked",{})})}.bind(this),n=e?this.tutorial.completePlacedExperience():this.tutorial.dismissPlacedExperience();return e&&(0,U["default"])(this._funnelPrefix+"_complete"),n.fin(this.tutorial.onExit.bind(this.tutorial)).then(i)},_setStep:function W(e){return D.debug("set step from",this.currentStep,"to",e),(0,U["default"])(this._funnelPrefix+"_step"+e),0>e||e>=this.steps.length?this._endTutorial(!0).then(function(){throw new Error("step is out of range")}):(this.currentStep=e,this._saveCurrentStep(),this.tutorial.nextStep(e))},isRunningTutorial:function X(){return this._isActive},setTutorialActive:function J(e){this._isActive=e},_getStoredData:function Z(){var e=N["default"].sessionStorage.getItem(l["default"].TUTORIAL_SESSION_KEY);return e&&e.experienceTutorial?e:null},canSupportExperience:function q(e){return s["default"].has(this.TUTORIAL_MAP,e.type)&&s["default"].has(e.display_data,"steps")},_saveCurrentStep:function z(){this.experience&&s["default"].contains([11021,11020],this.experience.experience_id)||N["default"].sessionStorage.setItem(l["default"].TUTORIAL_SESSION_KEY,{experience:this.experience,step:this.currentStep,experienceTutorial:!0})},clearStoredData:function Q(){N["default"].sessionStorage.removeItem(l["default"].TUTORIAL_SESSION_KEY)}};var j=null;F.instance=function(){return j||(j=new F),j},e.exports=w["default"].expose("ExperienceTutorialManager",F)},738:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(16),s=n(r),o=i(11),a=n(o),u=i(69),l=n(u),d=i(9),c=n(d),p=i(951),h=n(p),f=i(356),_=n(f),m=i(112),v=n(m),x=i(45),S=n(x),T=i(253),g=n(T),M=i(39),y=n(M),E=i(123),P=n(E),I=i(51),w=n(I),A=i(58),b=n(A),O=i(13),N=n(O),R=i(250),U=n(R),C=S["default"].getLogger("TutorialManager"),L=function j(e,t){this.url=e,this.forceRefresh=!!t},D=function B(){this.TUTORIAL_CONFIG={testTutorial:{stepNames:[],nextUrlInfo:function e(){return new L(null,!1)},canExit:!1,onUserExit:function t(){}},interestsNuxMweb:{stepNames:["NewUserWelcome","NewUserInterestPicker","NewUserSetupSpinner"],expiredSteps:{},canExit:!1,nextUrlInfo:function i(){return new L("/",!0)},onUserExit:function n(){}}},this.init()};D.prototype={init:function k(){this._isActive=!1,this.moduleContainer=null,this.renderModule=!0,this.progressModule=null,(0,s["default"])("body").removeClass(this.tutorialClassName),this.tutorialName=null,this.tutorialClassName=null,this.tutorial=null,this.allStepNames=null,this.numTotalSteps=null,this.currentStep=null,this.isZoomedIn=!1,U["default"].setTutorialManager(this)},startTutorial:function Y(e,t){if(t=t||{},U["default"].isTutorialActive())return Promise.reject(new Error("another tutorial is already active"));var i=this.TUTORIAL_CONFIG[e];return i?(this.moduleContainer=t.moduleContainer,this.renderModule=t.renderModule,this.progressModule=t.progressModule||this.progressModule,this._isActive?(this.renderModule===!1||this.currentModule||this._loadModuleForStep(this.currentStep),Promise.resolve()):(this._start(e,!0),Promise.resolve())):Promise.reject(new Error("tutorial config does not exist"))},setProgressModule:function G(e){this.progressModule!==e&&(this.progressModule=e,this.progressModule.listen(this.progressModule,"next",this._next.bind(this)),this.progressModule.listen(this.progressModule,"previous",this._previous.bind(this)),this._updateProgressModuleStep())},stopTutorial:function K(){this._isActive&&this.init()},resumeTutorial:function V(){if(!U["default"].isTutorialActive()){var e=this._getStoredData();e&&e.name&&this._start(e.name,!1)}},_start:function H(e,t){var i=this.TUTORIAL_CONFIG[e];i&&(this._clear(t),this._isActive=!0,this.tutorialName=e,this.tutorialClassName=this.tutorialName+c["default"].TUTORIAL_POSTFIX,(0,s["default"])("body").addClass(this.tutorialClassName),this.tutorial=i,this.expiredSteps=this.tutorial.expiredSteps,this.allStepNames=this.tutorial.stepNames,this.numTotalSteps=this.tutorial.stepNames.length,this._funnelPrefix="tutorial_"+e,this.renderModule=this.renderModule!==!1,!this.moduleContainer&&this.renderModule||this._setStep(this._getStoredStep()||this.allStepNames[0]),_["default"].log("tutorial."+e+"_started"))},isRunningTutorial:function W(){return this._isActive},_next:function X(){var e=this._getStepIndex(this.currentStep);return this.currentStep===a["default"].last(this.allStepNames)?void this._endTutorial(!0):void this._setStep(this.allStepNames[e+1])},_previous:function J(){var e=this._getStepIndex(this.currentStep);return 0===e?(g["default"].logToServer(g["default"].SERVER_LOG_TYPE.LOG,g["default"].HTTP_METHOD.POST,{type:"tutorial",tutorial:this.tutorialName,step:this.currentStep,step_number:e,action:"exit"}),this.tutorial.onUserExit(e),void this._endTutorial(!1)):void this._setStep(this.allStepNames[e-1])},_dismiss:function Z(){this._endTutorial(!1)},_endTutorial:function q(e){var t=function(){var t=this.tutorial.nextUrlInfo().url,i=this.tutorial.nextUrlInfo().forceRefresh;if(this._clear(!0),e&&t){var n=new P["default"];i&&(n.evt=new h["default"]("",null,{forceRefresh:1})),v["default"].navigate(t,n)}}.bind(this),i=function(){var e=this;return this.progressModule?this.progressModule.endMandatoryFlow().then(function(){e.progressModule&&e.progressModule.remove();var t=l["default"].instance;t.updateNavigationBar()}):Promise.resolve()}.bind(this),n=function(){var t=this,i=void 0;if(this.currentModule){var n=e?this.currentModule.completePlacedExperience():this.currentModule.dismissPlacedExperience();i=n.fin(function(){return new Promise(function(e){t.currentModule.onExit(e)})}),this.currentModule.onTutorialComplete()}else i=Promise.resolve();return i}.bind(this);n().then(i).then(t),e&&(0,N["default"])(this._funnelPrefix+"_complete")},_setStep:function z(e){var t=this;return(0,N["default"])(this._funnelPrefix+"_"+e),C.debug("set step from",this.currentStep,"to",e),e!==this.currentStep?(a["default"].contains(this.allStepNames,e)||this.expiredSteps[e]||this._endTutorial(!0),this.expiredSteps[e]&&(e=this.expiredSteps[e]),this.currentStep=e,this._saveCurrentStep(),this.currentModule?void this.currentModule.onExit(function(){t.currentModule.onRemoved(),t._loadModuleForStep(e)}):void(this.renderModule&&this._loadModuleForStep(this.currentStep))):void 0},_setNextStepClass:function Q(e){var t=(0,s["default"])("body"),i=null,n=this._getStepIndex(e);n>0&&(i=this.allStepNames[n-1],t.removeClass(i+c["default"].TUTORIAL_STEP_POSTFIX)),t.addClass(e+c["default"].TUTORIAL_STEP_POSTFIX)},_updateProgressModuleStep:function $(){if(this.currentStep){var e=this._getStepIndex(this.currentStep);this._setNextStepClass(this.currentStep),this.progressModule&&this.progressModule.nextStep(e+1)}},_loadModuleForStep:function ee(e){this.renderStepModule(e)},renderStepModule:function te(e){var t=this,i=this.getModuleArgs(e);e=e||this.tutorial.stepNames[0],y["default"].load(i).then(function(e){var i=t.currentModule;t.currentModule=e;var n=e;n.onEnter(function(){t._renderStepModule(e,i)})})},_renderStepModule:function ie(e,t){var i=this;e.render().then(function(){var t=i.moduleContainer.children[0];i.moduleContainer.prependChild(e),t&&t.destroy(),e.onShow(i._updateProgressModuleStep())})},getModuleArgs:function ne(e){var t=e,i={tutorial_name:this.tutorialName,current_step:this._getStepIndex(e),total_steps:this.numTotalSteps,can_exit:this.tutorial.canExit};return this.tutorial.stepExtraData&&this.tutorial.stepExtraData[e]&&(t=this.tutorial.stepExtraData[e].moduleName,Object.assign(i,this.tutorial.stepExtraData[e].options||{})),{name:t,options:i}},_getStepIndex:function re(e){var t=a["default"].indexOf(this.allStepNames,e);return-1!==t?t:0},_getStoredStep:function se(){var e=this._getStoredData();return e&&e.name!==this.tutorialName&&(this._clearStoredData(),e=null),e&&e.step||null},_getStoredData:function oe(){var e=b["default"].sessionStorage.getItem(c["default"].TUTORIAL_SESSION_KEY);return e&&e.experienceTutorial?null:e},_saveCurrentStep:function ae(){b["default"].sessionStorage.setItem(c["default"].TUTORIAL_SESSION_KEY,{name:this.tutorialName,step:this.currentStep,experienceTutorial:!1})},_clear:function ue(e){this.tutorial&&(this.stopTutorial(),e&&this._clearStoredData())},_clearStoredData:function le(){b["default"].sessionStorage.removeItem(c["default"].TUTORIAL_SESSION_KEY)}};var F=null;D.instance=function(){return F||(F=new D),F},e.exports=w["default"].expose("TutorialManager",D)},1040:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(54),s=n(r),o=i(39),a=n(o),u=i(51),l=n(u),d=function c(e,t){this.placedExperience=e,this.displayData=this.placedExperience.display_data,this.tutorialManager=t,this.storage={}};d.prototype={onStart:function p(){return new Promise(function(e,t){e(void 0)})},nextStep:function h(e){var t=this;return new Promise(function(i,n){t._removeStepModule().then(function(){t.loadStepModule(e),i(void 0)})})},loadStepModule:function f(e){var t=this,i=this.getModuleArgs(e);a["default"].load(i).then(function(e){var i=t.currentModule;t.currentModule=e;var n=e;n.onEnter(function(){t.renderStepModule(e,i)})})},getCurrentViewParameterType:function _(){return this.currentModule&&this.currentModule.getCurrentViewParameterType?this.currentModule.getCurrentViewParameterType():null},renderStepModule:function m(e,t){},_removeStepModule:function v(){var e=this.currentModule;return new Promise(function(t){e&&e.onExit(function(){e.onRemoved()}),t(void 0)})},getModuleArgs:function x(e){var t=this.displayData.steps,i=t[e].moduleName,n={tutorial_name:this.displayData.tutorialName,current_step:e,total_steps:t.length,can_exit:this.displayData.can_exit||!1,experienceID:this.placedExperience.experience_id,placementID:this.placedExperience.placement_id};return Object.assign(n,t[e].options),{name:i,options:n}},onExit:function S(){var e=this;return this._removeStepModule().then(function(){return e.currentModule&&e.currentModule.destroy(),Promise.resolve()})},dismissTutorial:function T(){this.tutorialManager&&this.tutorialManager.isRunningTutorial()&&this.tutorialManager._dismiss()},completePlacedExperience:function g(){return this.currentModule?this.currentModule.completePlacedExperience():this.placedExperience&&this.placedExperience.id?s["default"].instance.completePlacedExperienceId(this.placedExperience.id):Promise.resolve()},dismissPlacedExperience:function M(){return this.currentModule?this.currentModule.dismissPlacedExperience():this.placedExperience&&this.placedExperience.id?s["default"].instance.dismissPlacedExperienceId(this.placedExperience.id):Promise.resolve()},getStorage:function y(e){return this.storage[e]},setStorage:function E(e,t){this.storage[e]=t}},e.exports=l["default"].expose("ExperienceTutorial",d)},1298:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(11),s=n(r),o=i(2605),a=n(o),u=i(2603),l=n(u),d=i(111),c=n(d),p=i(2604),h=n(p),f=i(54),_=n(f),m=i(633),v=n(m),x=i(67),S=n(x),T=i(39),g=n(T),M=i(8),y=n(M),E=i(201),P=n(E),I=i(2606),w=n(I),A=i(13),b=n(A),O=i(738),N=n(O),R=i(250),U=n(R),C={};C.launchPlacedExperience=function(e,t,i){var n=_["default"].instance;return n.getPlacedExperienceWithContext(e,t).then(function(t){return t?C.launchFetchedPlacedExperience(t,e,i):Promise.resolve(!1)})},C.launchFetchedPlacedExperience=function(e,t,i){var n=_["default"].instance;if(e.placement_id=t,v["default"].instance().canSupportExperience(e))return v["default"].instance().startTutorial(e).then(function(){return n.viewPlacedExperience(t,e.experience_id),Promise.resolve(!0)});if(8===e.type)return(0,w["default"])().then(function(t){var i=new t({options:{anchor:e.display_data.anchor,append_to:e.display_data.append_to,experience:e,tooltip_only:e.display_data.tooltip_only,dismiss_on_event_types:e.display_data.dismiss_on_event_types,tooltip_options:Object.assign({},e.display_data),usm_placed_experience:e.usm_experience?e:null}});return i.render().then(function(){return y["default"].instance.publish("site","appendToMainModule",{module:i}),!0})});if(10026===e.experience_id){if(!U["default"].isTutorialActive())return(0,a["default"])().then(function(t){var i=new t({options:{placedExperienceId:e.id}});return S["default"].get().createAndShowModal(i,{only_modal:!0}),!0})}else if(500136===e.experience_id){if(!U["default"].isTutorialActive())return(0,h["default"])().then(function(t){var i=new t({resource:{name:"NetworkStoryByTypeResource",options:{story_type:"SYSTEM_BOARD_CREATE_RECS_FROM_EMAIL"}},options:{experience_id:e.experience_id,placement_id:e.placement_id,not_usm:!0}});return S["default"].get().createAndShowModal(i,{only_modal:!0}),!0})}else{if(s["default"].contains([11019,11023,500110,500131,500207],e.experience_id))return(0,l["default"])().then(function(t){var i=new t({options:{banner_text:e.display_data.banner_text,banner_string_unsafe:e.display_data.banner_string_unsafe,transition_button:e.display_data.transition_button,transition_event:e.display_data.transition_event,transition_text:e.display_data.transition_text,transition_string_unsafe:e.display_data.transition_string_unsafe,placed_experience_id:e.id,experience_id:e.experience_id}});return i.render().then(function(){return y["default"].instance.publish("site","appendToMainModule",{module:i}),!0})});if(5===e.type){if(i)return(0,c["default"])().then(function(t){var r=new t({options:e.display_data});return S["default"].get().createAndShowModal(r,{mask_type:"dark",can_dismiss:!1}),n.viewPlacedExperienceId(e.id),(0,b["default"])("web_survey_viewed"),i.listen(r,"confirm",function(){window.open(e.display_data.uri),n.completePlacedExperienceId(e.id),(0,b["default"])("web_survey_completed")}),i.listen(r,"close",function(){n.dismissPlacedExperienceId(e.id),(0,b["default"])("web_survey_dismissed")}),!0})}else{if(10===e.type)return e.display_data.module?(n.viewPlacedExperienceId(e.id),g["default"].load({name:e.display_data.module}).then(function(e){return(0,P["default"])().then(function(t){return t.addToast(e),!0})})):Promise.resolve(!1);var r=C.Tutorials[e.experience_id];if(r)return N["default"].instance().startTutorial(r,{display_data:e.display_data}).then(function(){return n.viewPlacedExperience(t,e.experience_id),Promise.resolve(!0)})}}},C.Tutorials={},C.Tutorials[10010]="firstPinIntro",C.Tutorials[10011]="yourBoards",C.Tutorials[40002]="interestsNuxMweb",C.Tutorials[60001]="analyticsHomeUserEd",C.Tutorials[60002]="analyticsAudienceSelectorUserEd",C.Tutorials[11002]="emptyBoardIntro",C.Tutorials[11004]="emptyBoardIntro",C.Tutorials[11007]="repin",C.Tutorials[11009]="repin",C.Tutorials[11024]="flashlightGuide",C.Tutorials[11026]="flashlightPulser",e.exports=C},1373:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(16),s=n(r),o=i(11),a=n(o),u=i(1040),l=n(u),d=i(45),c=n(d),p=i(67),h=n(p),f=i(51),_=n(f),m=i(18),v=n(m),x=c["default"].getLogger("ModalTutorial"),S=function T(e,t){l["default"].call(this,e,t),this.modal=null};S.prototype=Object.create(l["default"].prototype),S.prototype.onStart=function(){var e=this;return new Promise(function(t,i){return e.displayData.anchor&&!e._isOnScreen((0,s["default"])(e.displayData.anchor))?void i(new Error("Highlighted element is not on screen.")):void t(void 0)})},S.prototype.onExit=function(){this.modal&&(this.modal.destroy(),this.modal=null),l["default"].prototype.onExit.call(this)},S.prototype.renderStepModule=function(e,t){var i=this,n=void 0;if(this.modal){var r=function o(){t&&t.destroy()};n=this.modal.setSubmodule(e).then(r,r)}else{var s=(this.displayData.modalStyle+" "||"")+v["default"].attributes.gender;n=h["default"].get().createAndShowModalCorrect(e,{mask_type:"dark",can_dismiss:!1,modal_style:s}).then(function(t){i.modal=t,e.modal=t,i.modal.childListen("next",i.tutorialManager._next.bind(i.tutorialManager)),i.modal.childListen("previous",i.tutorialManager._previous.bind(i.tutorialManager))})}return n.then(function(){a["default"].isUndefined(e.setModalPosition)||e.setModalPosition(),e.onShow()})["catch"](function(e){x.debug(e)})},S.prototype._isOnScreen=function(e){if(e.length){var t=(0,s["default"])(window),i=t.scrollTop(),n=i+t.height(),r=e.offset().top,o=r+e.height();return n>=o&&r>=i}return!1},e.exports=_["default"].expose("ModalTutorial",S)},1947:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(44),s=n(r),o=i(29),a=n(o),u=i(1040),l=n(u),d=i(1948),c=n(d),p=function h(e,t){l["default"].call(this,e,t),this.SUB_TUTORIAL_MAP={modal:c["default"]},this._subTutorial=null;var i=void 0;this.displayData.modal?i=c["default"]:this.SUB_TUTORIAL_MAP[this.displayData.sub_type]&&(i=this.SUB_TUTORIAL_MAP[this.displayData.sub_type]),i&&(this._subTutorial=new i(this.placedExperience,this.tutorialManager))};p.prototype=Object.create(l["default"].prototype),p.prototype.onStart=function(){return this._subTutorial.onStart()},p.prototype.onExit=function(){return this._subTutorial.onExit().then(function(){var e={event_type:4105,view_type:24},t=s["default"].fromPlainObject(e);a["default"].getInstance().addEvent(t)})},p.prototype.nextStep=function(e){var t=this;return this._subTutorial.nextStep(e).then(function(){if(0===e){var t={event_type:4104,view_type:24},i=s["default"].fromPlainObject(t);a["default"].getInstance().addEvent(i)}}).then(function(){var e=t._subTutorial.getCurrentViewParameterType();if(e){var i={event_type:13,view_type:24,view_parameter:e},n=s["default"].fromPlainObject(i);a["default"].getInstance().addEvent(n)}})},e.exports=p},1948:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(67),s=n(r),o=i(1373),a=n(o),u=function l(e,t){a["default"].call(this,e,t)};u.prototype=Object.create(a["default"].prototype),u.prototype.onExit=function(){var e=this.modal;return e?(this.modal=null,s["default"].get().removeModalWithAnimation(e,".flexibleSetup",500)):Promise.resolve()},e.exports=u},2603:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(150,function(t){e(i(1127))})})}},2604:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(148,function(t){e(i(1716))})})}},2605:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(149,function(t){e(i(1128))})})}},2606:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(151,function(t){e(i(1717))})})}}});